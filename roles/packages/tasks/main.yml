- name: include variable files
  include_vars: "{{ item }}"
  loop:
    - "{{ role_path }}/vars/{{ ansible_facts.architecture }}.yml"
  when: item is file

- name: install CLI repos and packages
  import_tasks: 01_cli.yml
  when: ansible_facts.pkg_mgr not in ['atomic_container']

- block:
    - name: setup user-space virtualenvs
      import_tasks: 02_virtualenv.yml

    - name: setup libvirt
      import_tasks: 03_libvirt.yml
      when: ansible_facts.architecture != 'aarch64'

    - name: setup packer
      import_tasks: 04_packer.yml
      when: ansible_facts.architecture != 'aarch64'
  when: "'WSLENV' not in ansible_facts.env"

- name: setup kerberos
  import_tasks: 05_kerberos.yml
  when: kerberos is defined
